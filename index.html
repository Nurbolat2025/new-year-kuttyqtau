<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–µ—Ä–µ–∫–µ–ª—ñ 2026</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0d47a1">
    <link rel="icon" type="image/png" href="icon-192.png">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        body {
            margin: 0; padding: 0;
            min-height: 100vh;
            color: white;
            text-align: center;
            font-family: 'Segoe UI', Tahoma, sans-serif;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #000;
        }

        /* --- –ö–ê–†–¢–ê --- */
        #map { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
        .overlay { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0, 20, 40, 0.7); /* –ö–∞—Ä—Ç–∞–Ω—ã —Å”ô–ª “õ–∞—Ä–∞–π—Ç—É */
            z-index: 1; pointer-events: none; 
        }

        /* --- –ñ–û“í–ê–†“í–´ –ú”ò–ó–Ü–† --- */
        .top-controls {
            position: fixed; top: 20px; right: 20px; z-index: 1000;
            display: flex; gap: 10px;
        }
        .icon-btn {
            background: rgba(0,0,0,0.5); color: white;
            border: 1px solid rgba(255,255,255,0.3); border-radius: 50%;
            width: 45px; height: 45px; font-size: 20px; cursor: pointer;
            backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center;
        }
        .lang-select {
            background: rgba(255, 255, 255, 0.95); border-radius: 20px; padding: 5px 15px;
            font-weight: bold; border: none; cursor: pointer; outline: none;
        }

        /* --- –û–†–¢–ê“¢“í–´ –ö–ê–†–¢–û–ß–ö–ê --- */
        .card {
            position: relative; z-index: 100;
            background: rgba(0, 0, 0, 0.6); /* –ú”©–ª–¥—ñ—Ä “õ–∞—Ä–∞ */
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            padding: 25px; border-radius: 25px;
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 15px 50px rgba(0,0,0,0.7);
            width: 90%; max-width: 420px;
            transition: transform 0.3s ease;
        }

        h1 { color: #FFD700; text-shadow: 0 0 15px #FF8C00; font-size: 1.8rem; margin: 10px 0; }

        /* –¢–∞–π–º–µ—Ä —Å—Ç–∏–ª—ñ */
        .countdown-box {
            font-family: 'Courier New', monospace;
            background: rgba(0, 255, 255, 0.1);
            color: #84ffff;
            padding: 10px; border-radius: 12px;
            margin: 15px 0;
            font-size: 1.1rem; border: 1px solid rgba(132, 255, 255, 0.3);
            text-shadow: 0 0 5px #84ffff;
        }

        /* –°–∞–Ω–¥—ã“õ */
        .chest-wrapper { margin: 30px 0; cursor: pointer; animation: float 3s ease-in-out infinite; }
        .chest-icon { font-size: 80px; filter: drop-shadow(0 0 20px gold); }
        .chest-hint { font-size: 0.9rem; color: #aaa; margin-top: 10px; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* –ú”ô—Ç—ñ–Ω–¥–µ—Ä –º–µ–Ω ”®–ª–µ“£ */
        .city-name { font-size: 2rem; color: #4DD0E1; margin: 5px 0; text-shadow: 2px 2px 4px black; }
        .greeting-text { font-size: 1.1rem; line-height: 1.5; color: #eee; margin: 15px 0; }
        
        .poem-box {
            background: rgba(0, 40, 0, 0.4); /* –ò—Å–ª–∞–º–∏ –∂–∞—Å—ã–ª —Ä–µ“£–∫ */
            padding: 15px; border-radius: 15px;
            margin: 15px 0; border-left: 4px solid #FFD700;
            font-style: italic; white-space: pre-line;
            color: #fffde7; font-size: 1rem; line-height: 1.6;
            text-shadow: 1px 1px 2px black;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        /* Input & Buttons */
        input { width: 85%; padding: 12px; margin: 10px 0; border-radius: 12px; border: none; text-align: center; font-size: 16px; }
        .main-btn {
            width: 100%; padding: 14px; margin: 8px 0;
            border-radius: 12px; border: none; font-size: 16px; font-weight: bold;
            background: linear-gradient(135deg, #FFD700 0%, #FFA000 100%);
            color: #000; cursor: pointer; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }
        .main-btn:active { transform: scale(0.98); }
        .share-btn { background: linear-gradient(135deg, #eee 0%, #ccc 100%); color: #333; }

        .hidden { display: none !important; }
        
        /* “∞—à–∞“õ –∏–∫–æ–Ω–∫–∞—Å—ã –∫–∞—Ä—Ç–∞–¥–∞ */
        .plane-icon { font-size: 30px; text-shadow: 0 0 10px black; }
    </style>
</head>
<body>

    <div id="map"></div>
    <div class="overlay"></div>

    <audio id="bgMusic" loop preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2022/10/25/audio_1f23348651.mp3" type="audio/mp3">
    </audio>

    <div class="top-controls">
        <button id="musicBtn" class="icon-btn" onclick="toggleMusic()">üîá</button>
        <select id="uiLangSelect" class="lang-select" onchange="changeLanguage()">
            <option value="kk">üá∞üáø “ö–ê–ó</option>
            <option value="ru">üá∑üá∫ –†–£–°</option>
            <option value="en">üá∫üá∏ ENG</option>
            <option value="tr">üáπüá∑ TUR</option>
            <option value="ar">üá¶üá™ ARA</option>
        </select>
    </div>

    <div id="loginScreen" class="card">
        <h1>üåô –ë–µ—Ä–µ–∫–µ–ª—ñ 2026</h1>
        <div id="loginCountdown" class="countdown-box">–ñ“Ø–∫—Ç–µ–ª—É–¥–µ...</div>
        
        <p id="appDesc">–ê–¥–∞–ª –Ω–∏–µ—Ç–ø–µ–Ω “õ“±—Ç—Ç—ã“õ—Ç–∞—É –∂–æ–ª–¥–∞“£—ã–∑!</p>
        <input type="text" id="nameInput" placeholder="–ï—Å—ñ–º—ñ“£—ñ–∑...">
        <button onclick="startJourney()" class="main-btn" id="btnStart">–ë–∞—Å—Ç–∞—É ü§≤</button>
    </div>

    <div id="journeyScreen" class="card hidden">
        
        <div id="mainCountdown" class="countdown-box"></div>

        <div id="chestWrapper" class="chest-wrapper" onclick="openChest()">
            <div class="chest-icon">üéÅ</div>
            <div class="chest-hint" id="chestHint">–°—ã–π–ª—ã“õ—Ç—ã –∞—à—É “Ø—à—ñ–Ω –±–∞—Å—ã“£—ã–∑!</div>
        </div>

        <div id="contentWrapper" class="hidden">
            <h2 id="cityName" class="city-name">City</h2>
            
            <div id="greetingMsg" class="greeting-text">...</div>
            
            <div id="poemBox" class="poem-box">...</div>
            
            <button onclick="nextCity()" class="main-btn" id="btnNext">–ö–µ–ª–µ—Å—ñ –µ–ª ‚úàÔ∏è</button>
            <button onclick="shareGreeting()" class="main-btn share-btn" id="btnShare">–ë”©–ª—ñ—Å—É üîó</button>
        </div>
    </div>

    <script>
        // --- –ë–ê–†–õ–´“ö –ú”ò–¢–Ü–ù–î–ï–† (”®–õ–ï“¢–î–ï–† –û–°–´–ù–î–ê) ---
        // 2026 –ñ—ã–ª - –ñ—ã–ª“õ—ã –∂—ã–ª—ã
        const targetDate = new Date("January 1, 2026 00:00:00").getTime();

        const translations = {
            kk: {
                ui: { title: "–ë–µ—Ä–µ–∫–µ–ª—ñ 2026 –ñ—ã–ª", desc: "–ê—Ç—ã“£—ã–∑–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑:", ph: "–ê—Ç—ã“£—ã–∑...", start: "–ë–∞—Å—Ç–∞—É ü§≤", next: "–ö–µ–ª–µ—Å—ñ –µ–ª ‚úàÔ∏è", share: "–ë”©–ª—ñ—Å—É üîó", hint: "–°—ã–π–ª—ã“õ—Ç—ã –∞—à—É “Ø—à—ñ–Ω –±–∞—Å—ã“£—ã–∑! üéÅ", days: "–∫“Ø–Ω", hours: "—Å–∞“ì", mins: "–º–∏–Ω", secs: "—Å–µ–∫" },
                // –ñ–∞“£–∞ –∂—ã–ª –∫–µ–ª–≥–µ–Ω–≥–µ –¥–µ–π—ñ–Ω
                coming: {
                    greet: "“ö“±—Ä–º–µ—Ç—Ç—ñ {name}, –∫–µ–ª–µ –∂–∞—Ç“õ–∞–Ω –ñ–∞“£–∞ –∂—ã–ª–¥–∞ –ê–ª–ª–∞ –¢–∞“ì–∞–ª–∞ –µ–∫—ñ –¥“Ø–Ω–∏–µ–Ω—ñ“£ –∂–∞“õ—Å—ã–ª—ã“ì—ã–Ω –Ω”ô—Å—ñ–ø –µ—Ç—Å—ñ–Ω! –ï–ª—ñ–º—ñ–∑ —Ç—ã–Ω—ã—à, –∂“±—Ä—Ç—ã–º—ã–∑ –∞–º–∞–Ω –±–æ–ª—Å—ã–Ω.",
                    poem: "–ê–ª–ª–∞ “õ–æ–ª–¥–∞–ø ”ô—Ä —ñ—Å—ñ“£–¥—ñ –æ“£ “õ—ã–ª—Å—ã–Ω,\n–†–∏–∑—ã“õ-–Ω–µ—Å—ñ–±–µ“£ –∞–¥–∞–ª—ã–Ω–∞–Ω –º–æ–ª –±–æ–ª—Å—ã–Ω.\n–ö–µ–ª–µ –∂–∞—Ç“õ–∞–Ω –∂—ã–ª–¥–∞ –º—ã–Ω–∞—É –∂–∞“£–∞—Ä—ã–ø,\n–ò–º–∞–Ω—ã“£—ã–∑ –Ω“±—Ä“ì–∞ —Ç–æ–ª—ã –∑–æ—Ä –±–æ–ª—Å—ã–Ω!"
                },
                // –ñ–∞“£–∞ –∂—ã–ª –∫–µ–ª–≥–µ–Ω —Å–æ“£
                arrived: {
                    greet: "“ö“±—Ä–º–µ—Ç—Ç—ñ {name}, –∫–µ–ª—ñ–ø –∂–µ—Ç–∫–µ–Ω –ñ–∞“£–∞ –∂—ã–ª–¥–∞ –ê–ª–ª–∞ –¢–∞“ì–∞–ª–∞ ”ô—Ä–±—ñ—Ä –∫“Ø–Ω—ñ“£—ñ–∑–≥–µ –±–µ—Ä–µ–∫–µ –±–µ—Ä—Å—ñ–Ω!",
                    poem: "–ñ–∞“£–∞ –∂—ã–ª–¥–∞ –∂–∞“õ—Å—ã–ª—ã“õ—Ç–∞—Ä –∫”©–ø –±–æ–ª—Å—ã–Ω,\n–£–∞–π—ã–º-“õ–∞–π“ì—ã –µ—à“õ–∞—à–∞–Ω–¥–∞ –∂–æ“õ –±–æ–ª—Å—ã–Ω.\n–ê–ª–ª–∞ –±–µ—Ä–≥–µ–Ω “ì“±–º—ã—Ä—ã“£—ã–∑ –º”ô–Ω–¥—ñ –±–æ–ø,\n–î–∞—Å—Ç–∞—Ä—Ö–∞–Ω—ã“£ –∞–¥–∞–ª –∞—Å“õ–∞ —Ç–æ“õ –±–æ–ª—Å—ã–Ω!"
                }
            },
            ru: {
                ui: { title: "–ë–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–Ω—ã–π 2026", desc: "–í–≤–µ–¥–∏—Ç–µ –∏–º—è:", ph: "–í–∞—à–µ –∏–º—è...", start: "–û—Ç–∫—Ä—ã—Ç—å ü§≤", next: "–°–ª–µ–¥. —Å—Ç—Ä–∞–Ω–∞ ‚úàÔ∏è", share: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è üîó", hint: "–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—É–Ω–¥—É–∫! üéÅ", days: "–¥–Ω", hours: "—á", mins: "–º", secs: "—Å" },
                coming: {
                    greet: "–£–≤–∞–∂–∞–µ–º—ã–π(–∞—è) {name}, –≤ –Ω–∞—Å—Ç—É–ø–∞—é—â–µ–º –≥–æ–¥—É –ø—É—Å—Ç—å –í—Å–µ–≤—ã—à–Ω–∏–π –¥–∞—Ä—É–µ—Ç –≤–∞–º –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ!",
                    poem: "–ü—É—Å—Ç—å –ê–ª–ª–∞—Ö —Ö—Ä–∞–Ω–∏—Ç –æ—Ç –±–µ–¥,\n–î–∞—Ä–∏—Ç –º—É–¥—Ä–æ—Å—Ç—å –∏ —Å–æ–≤–µ—Ç.\n–í –Ω–∞—Å—Ç—É–ø–∞—é—â–µ–º –≥–æ–¥—É,\n–û—Ç–≤–æ–¥–∏—Ç –≥–æ—Ä–µ –∏ –±–µ–¥—É."
                },
                arrived: {
                    greet: "–£–≤–∞–∂–∞–µ–º—ã–π(–∞—è) {name}, –≤ –Ω–∞—Å—Ç—É–ø–∏–≤—à–µ–º –≥–æ–¥—É –ø—É—Å—Ç—å –í—Å–µ–≤—ã—à–Ω–∏–π –Ω–∞–ø–æ–ª–Ω–∏—Ç –≤–∞—à –¥–æ–º –±–∞—Ä–∞–∫–∞—Ç–æ–º!",
                    poem: "–ì–æ–¥ –ø—Ä–∏—à–µ–ª, —Ö–≤–∞–ª–∞ –¢–≤–æ—Ä—Ü—É,\n–°—á–∞—Å—Ç—å–µ –ø—É—Å—Ç—å –ø—Ä–∏–¥–µ—Ç –∫ –ª–∏—Ü—É.\n–ú–∏—Ä, –ø–æ–∫–æ–π –∏ –±–ª–∞–≥–æ–¥–∞—Ç—å,\n–ë—É–¥—É—Ç –¥–æ–º –≤–∞—à –Ω–∞–ø–æ–ª–Ω—è—Ç—å."
                }
            },
            en: {
                ui: { title: "Blessed 2026", desc: "Enter name:", ph: "Name...", start: "Start ü§≤", next: "Next ‚úàÔ∏è", share: "Share üîó", hint: "Tap the chest! üéÅ", days: "d", hours: "h", mins: "m", secs: "s" },
                coming: {
                    greet: "Dear {name}, may the Almighty grant you success and halal sustenance in the coming year!",
                    poem: "May Allah guide you day by day,\nKeep all troubles far away.\nIn the coming year so new,\nMay His blessings be with you."
                },
                arrived: {
                    greet: "Dear {name}, may the Almighty fill your life with peace and faith in this new year!",
                    poem: "New year is here, bright and clear,\nMay faith in heart be ever near.\nGoodness, health, and halal wealth,\nJoy and peace and spiritual health."
                }
            },
            tr: {
                ui: { title: "Bereketli 2026", desc: "Adƒ±nƒ±z:", ph: "Adƒ±nƒ±z...", start: "Ba≈üla ü§≤", next: "Sonraki ‚úàÔ∏è", share: "Payla≈ü üîó", hint: "Sandƒ±ƒüa tƒ±kla! üéÅ", days: "g", hours: "s", mins: "dk", secs: "sn" },
                coming: {
                    greet: "Sevgili {name}, yakla≈üan yeni yƒ±lda Allah size hayƒ±rlƒ± rƒ±zƒ±klar nasip etsin!",
                    poem: "Rabbim yolunu a√ßƒ±k etsin,\nHer t√ºrl√º dertten seni korusun.\nYeni yƒ±lda t√ºm dualarƒ±n,\nHayƒ±rlƒ±sƒ±yla kabul olsun."
                },
                arrived: {
                    greet: "Sevgili {name}, yeni yƒ±lda Allah hanenize bereket versin!",
                    poem: "Yeni yƒ±l geldi ho≈ü geldi,\nG√∂nl√ºne iman dolsun ebedi.\nRabbimden dilerim saadet,\nHayatƒ±n olsun hep selamet."
                }
            },
            ar: {
                ui: { title: "ÿπÿßŸÖ ŸÖÿ®ÿßÿ±ŸÉ 2026", desc: "ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖŸÉ:", ph: "ÿßŸÑÿßÿ≥ŸÖ...", start: "ÿßÿ®ÿØÿ£ ü§≤", next: "ÿßŸÑÿ™ÿßŸÑŸä ‚úàÔ∏è", share: "ŸÖÿ¥ÿßÿ±ŸÉÿ© üîó", hint: "ÿßÿ∂ÿ∫ÿ∑ ÿßŸÑÿµŸÜÿØŸàŸÇ! üéÅ", days: "Ÿä", hours: "ÿ≥", mins: "ÿØ", secs: "ÿ´" },
                coming: {
                    greet: "ÿπÿ≤Ÿäÿ≤Ÿä {name}ÿå ÿ£ÿ≥ÿ£ŸÑ ÿßŸÑŸÑŸá ÿ£ŸÜ Ÿäÿ±ÿ≤ŸÇŸÉ ÿßŸÑÿ±ÿ≤ŸÇ ÿßŸÑÿ≠ŸÑÿßŸÑ ŸÅŸä ÿßŸÑÿπÿßŸÖ ÿßŸÑŸÇÿßÿØŸÖ!",
                    poem: "Ÿäÿß ÿ±ÿ® ÿ®ÿßÿ±ŸÉ ŸÅŸä ÿßŸÑÿπÿßŸÖ ÿßŸÑÿ¨ÿØŸäÿØÿå\nŸàÿßÿ¨ÿπŸÑ ÿ≠Ÿäÿßÿ© {name} ŸÅŸä ÿπŸäÿØ.\nÿ®ÿßŸÑÿ•ŸäŸÖÿßŸÜ ŸàÿßŸÑÿ™ŸÇŸàŸâ ÿ™ÿ≤ŸäÿØÿå\nŸàÿ±ÿ∂ÿß ÿßŸÑÿ±ÿ≠ŸÖŸÜ ŸáŸà ÿßŸÑŸÖÿ≤ŸäÿØ."
                },
                arrived: {
                    greet: "ÿπÿ≤Ÿäÿ≤Ÿä {name}ÿå ÿ£ÿ≥ÿ£ŸÑ ÿßŸÑŸÑŸá ÿ£ŸÜ ŸäŸÖŸÑÿ£ ÿ≠Ÿäÿßÿ™ŸÉ ÿ®ÿßŸÑŸÜŸàÿ± ŸàÿßŸÑÿ®ÿ±ŸÉÿ©!",
                    poem: "ÿπÿßŸÖ ÿ¨ÿØŸäÿØ ÿ£ŸÇÿ®ŸÑ ÿπŸÑŸäŸÜÿßÿå\nŸÜÿ≥ÿ£ŸÑ ÿßŸÑŸÑŸá ÿßŸÑŸÑÿ∑ŸÅ ŸÅŸäŸÜÿß.\nÿßÿ±ÿ≤ŸÇŸÜÿß Ÿäÿß ÿ±ÿ® ÿßŸÑÿ¨ŸÜÿßŸÜÿå\nŸàÿßÿ≠ŸÅÿ∏ŸÜÿß ŸÖŸÜ ŸÉŸÑ ÿ¥Ÿäÿ∑ÿßŸÜ."
                }
            }
        };

        const destinations = [
            { name: "Astana üá∞üáø", coords: [51.16, 71.47], lang: "kk" },
            { name: "Mecca üá∏üá¶", coords: [21.38, 39.85], lang: "ar" },
            { name: "Istanbul üáπüá∑", coords: [41.00, 28.97], lang: "tr" },
            { name: "London üá¨üáß", coords: [51.50, -0.12], lang: "en" },
            { name: "Tashkent üá∫üáø", coords: [41.29, 69.24], lang: "ru" }
        ];

        // --- –õ–û–ì–ò–ö–ê ---
        let map, planeMarker;
        let currentDestIndex = 0;
        let userName = "–î–æ—Å—ã–º";
        let isMusicPlaying = false;
        const audio = document.getElementById('bgMusic');

        // –ñ“Ø–∫—Ç–µ–ª–≥–µ–Ω–¥–µ
        window.onload = () => {
            initMap();
            setInterval(updateCountdown, 1000);
            updateCountdown(); 
            changeLanguage(); // –¢—ñ–ª–¥—ñ —Ä–µ—Ç—Ç–µ—É
        };

        function initMap() {
            // –ö–∞—Ä—Ç–∞–Ω—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è–ª–∞—É (Dark mode)
            map = L.map('map', { zoomControl: false }).setView([51.16, 71.47], 4);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '', subdomains: 'abcd', maxZoom: 19
            }).addTo(map);

            // “∞—à–∞“õ –±–µ–ª–≥—ñ—Å—ñ
            const planeIcon = L.divIcon({
                html: '<div style="font-size: 30px; transform: rotate(-45deg);">‚úàÔ∏è</div>',
                className: 'plane-icon',
                iconSize: [30, 30],
                iconAnchor: [15, 15]
            });
            planeMarker = L.marker([51.16, 71.47], {icon: planeIcon}).addTo(map);
        }

        // –¢–∞–π–º–µ—Ä–¥—ñ –∂–∞“£–∞—Ä—Ç—É
        function updateCountdown() {
            const now = new Date().getTime();
            const distance = targetDate - now;
            const lang = document.getElementById('uiLangSelect').value;
            const t = translations[lang].ui; // “ö–∞–∑—ñ—Ä–≥—ñ —Ç—ñ–ª–¥–µ–≥—ñ —Å”©–∑–¥–µ—Ä–¥—ñ –∞–ª–∞–º—ã–∑

            if (distance < 0) {
                // –ñ—ã–ª –∫–µ–ª–¥—ñ
                const msg = "üéâ 2026!";
                document.getElementById('loginCountdown').textContent = msg;
                document.getElementById('mainCountdown').textContent = msg;
            } else {
                // –ñ—ã–ª –∫–µ–ª–º–µ–¥—ñ
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                
                // –¢—ñ–ª–≥–µ –±–∞–π–ª–∞–Ω—ã—Å—Ç—ã –¥“±—Ä—ã—Å —Å”©–∑–¥–µ—Ä–¥—ñ “õ–æ—é
                const timeStr = `‚è≥ ${days}${t.days} ${hours}${t.hours} ${minutes}${t.mins} ${seconds}${t.secs}`;
                
                document.getElementById('loginCountdown').textContent = timeStr;
                document.getElementById('mainCountdown').textContent = timeStr;
            }
        }

        // –¢—ñ–ª –∞—É—ã—Å—Ç—ã—Ä—É
        function changeLanguage() {
            const lang = document.getElementById('uiLangSelect').value;
            const t = translations[lang].ui;

            // –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º”ô—Ç—ñ–Ω–¥–µ—Ä—ñ–Ω –∂–∞“£–∞—Ä—Ç—É
            document.querySelector('#loginScreen h1').textContent = t.title;
            document.getElementById('appDesc').textContent = t.desc;
            document.getElementById('nameInput').placeholder = t.ph;
            document.getElementById('btnStart').textContent = t.start;
            document.getElementById('chestHint').textContent = t.hint;

            // –ï–≥–µ—Ä —ñ—à—ñ–Ω–¥–µ –±–æ–ª—Å–∞“õ, –∫–∞—Ä—Ç–∞–¥–∞“ì—ã –º”ô—Ç—ñ–Ω–¥—ñ –¥–µ –∂–∞“£–∞—Ä—Ç—É
            if (!document.getElementById('contentWrapper').classList.contains('hidden')) {
                updateCardContent();
            }
        }

        function toggleMusic() {
            if (isMusicPlaying) {
                audio.pause(); isMusicPlaying = false; 
                document.getElementById('musicBtn').textContent = "üîá";
            } else {
                audio.play(); isMusicPlaying = true; 
                document.getElementById('musicBtn').textContent = "üéµ";
            }
        }

        function startJourney() {
            userName = document.getElementById('nameInput').value.trim() || "–î–æ—Å—ã–º";
            
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('journeyScreen').classList.remove('hidden');
            
            if(!isMusicPlaying) toggleMusic();

            // –¢—ñ–ª–¥—ñ —Å”ô–π–∫–µ—Å “õ–∞–ª–∞“ì–∞ –±–∞–ø—Ç–∞—É
            const lang = document.getElementById('uiLangSelect').value;
            const cityIndex = destinations.findIndex(d => d.lang === lang);
            if(cityIndex !== -1) currentDestIndex = cityIndex;

            // –ö–∞—Ä—Ç–∞–Ω—ã “±—à—ã—Ä—É
            const city = destinations[currentDestIndex];
            map.flyTo(city.coords, 5, { duration: 2.5 });
            planeMarker.setLatLng(city.coords);
        }

        // –°–∞–Ω–¥—ã“õ—Ç—ã –∞—à—É
        function openChest() {
            // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ (–ñ—ã–ª“õ—ã, –ì“Ø–ª)
            confetti({
                particleCount: 100, spread: 70, origin: { y: 0.6 },
                shapes: ['circle'], colors: ['#FFD700', '#FF0000', '#00FF00']
            });
            // –≠–º–æ–¥–∑–∏ –∞—Ç—É
            const scalar = 3;
            const emojis = confetti.shapeFromText({ text: 'üê¥', scalar });
            const flowers = confetti.shapeFromText({ text: 'üå∏', scalar });
            
            confetti({
                particleCount: 15, scalar: 3, spread: 100, origin: { y: 0.7 },
                shapes: [emojis, flowers]
            });

            // –°–∞–Ω–¥—ã“õ—Ç—ã –∂–∞—Å—ã—Ä—É, –º”ô—Ç—ñ–Ω–¥—ñ –∞—à—É
            document.getElementById('chestWrapper').style.display = 'none';
            document.getElementById('contentWrapper').classList.remove('hidden');
            
            updateCardContent();
        }

        function updateCardContent() {
            const city = destinations[currentDestIndex];
            
            // –¢—ñ–ª–¥—ñ “õ–∞–ª–∞“ì–∞ “õ–∞—Ä–∞–ø –µ–º–µ—Å, Dropdown-“ì–∞ “õ–∞—Ä–∞–ø “õ–æ—é“ì–∞ –¥–∞ –±–æ–ª–∞–¥—ã,
            // –±—ñ—Ä–∞“õ "–∫–µ–ª–µ—Å—ñ –µ–ª–≥–µ" –±–∞—Å“õ–∞–Ω–¥–∞ —Ç—ñ–ª –∞—É—ã—Å—Å—ã–Ω –¥–µ—Å–µ“£—ñ–∑:
            const langCode = city.lang;
            document.getElementById('uiLangSelect').value = langCode;
            
            // –ú”ô—Ç—ñ–Ω–¥—ñ –∞–ª—É
            const t = translations[langCode];
            const now = new Date().getTime();
            const data = (now >= targetDate) ? t.arrived : t.coming;

            // DOM –∂–∞“£–∞—Ä—Ç—É
            document.getElementById('cityName').textContent = city.name;
            document.getElementById('greetingMsg').innerHTML = data.greet.replace("{name}", `<b style="color:#FFD700">${userName}</b>`);
            document.getElementById('poemBox').textContent = data.poem; // ”®–ª–µ“£ –æ—Å—ã–Ω–¥–∞ —Ç“Ø—Å–µ–¥—ñ
            
            document.getElementById('btnNext').textContent = t.ui.next;
            document.getElementById('btnShare').textContent = t.ui.share;
        }

        function nextCity() {
            currentDestIndex = (currentDestIndex + 1) % destinations.length;
            const city = destinations[currentDestIndex];
            
            map.flyTo(city.coords, 5, { duration: 2.5 });
            planeMarker.setLatLng(city.coords);
            
            updateCardContent();
        }

        function shareGreeting() {
            const url = window.location.href.split('?')[0] + "?name=" + encodeURIComponent(userName);
            if (navigator.share) {
                navigator.share({ title: '2026 Wish', url: url });
            } else {
                navigator.clipboard.writeText(url);
                alert("Copied!");
            }
        }
    </script>
</body>
</html>
