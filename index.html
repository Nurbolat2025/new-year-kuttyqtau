<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ñ–∞“£–∞ –ñ—ã–ª 2026</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0d47a1">
    <link rel="icon" type="image/png" href="icon-192.png">

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        body {
            margin: 0; padding: 0;
            min-height: 100vh;
            background: linear-gradient(to bottom, #000428, #004e92);
            color: white;
            text-align: center;
            font-family: 'Segoe UI', sans-serif;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* --- –ñ–û“í–ê–†“í–´ –¢“∞–†–ê“ö–¢–´ –ú”ò–ó–Ü–† (FIXED TOP BAR) --- */
        .top-controls {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            background: rgba(0, 0, 0, 0.4);
            padding: 8px;
            border-radius: 30px;
            backdrop-filter: blur(5px);
        }

        .icon-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px; height: 40px;
            font-size: 20px;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: 0.3s;
        }
        .icon-btn:hover { background: rgba(255, 255, 255, 0.4); transform: scale(1.1); }
        .icon-btn.playing { background: #4caf50; animation: pulse 2s infinite; }

        select.lang-select {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            border: none;
            border-radius: 20px;
            padding: 5px 15px;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            outline: none;
        }

        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); } 100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); } }

        /* --- –ù–ï–ì–Ü–ó–ì–Ü –°–¢–ò–õ–¨–î–ï–† --- */
        h1 { color: #ffeb3b; text-shadow: 0 0 15px #ff9800; font-size: 1.8rem; margin: 20px 0; padding: 0 10px;}
        
        .card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(12px);
            padding: 25px;
            border-radius: 25px;
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            width: 90%; max-width: 450px;
            margin-top: 60px; /* Top bar –æ—Ä—ã–Ω “õ–∞–ª–¥—ã—Ä—É “Ø—à—ñ–Ω */
            transition: transform 0.3s;
        }

        input {
            width: 90%; padding: 12px; margin: 15px 0;
            border-radius: 12px; border: none; font-size: 16px; text-align: center;
        }
        
        button.main-btn {
            width: 100%; padding: 14px; margin: 10px 0;
            border-radius: 12px; border: none; font-size: 16px; font-weight: bold;
            background: linear-gradient(45deg, #ff512f, #dd2476);
            color: white; cursor: pointer;
            box-shadow: 0 4px 15px rgba(221, 36, 118, 0.5);
        }
        
        button.share-btn {
            background: linear-gradient(45deg, #11998e, #38ef7d);
            box-shadow: 0 4px 15px rgba(56, 239, 125, 0.4);
        }

        .hidden { display: none; }
        
        /* City & Poem Styles */
        .city-name { font-size: 1.8rem; color: #4dd0e1; margin: 10px 0; text-shadow: 2px 2px 4px #000; }
        .greeting-text { font-size: 1.1rem; margin: 15px 0; line-height: 1.5; }
        
        .poem-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px; border-radius: 15px;
            margin: 15px 0;
            border-left: 4px solid #ffeb3b;
            font-style: italic;
            white-space: pre-line;
            color: #fffde7;
            font-size: 1rem;
        }

        .snowflake {
            position: absolute; color: #fff; opacity: 0.8; 
            pointer-events: none; animation: fall linear infinite; z-index: -1;
        }
        @keyframes fall { to { transform: translateY(100vh); } }
    </style>
</head>
<body>

    <audio id="bgMusic" loop>
        <source src="https://upload.wikimedia.org/wikipedia/commons/e/e9/Jingle_Bells_%28Kevin_MacLeod%29_%28ISRC_USUAN1100187%29.mp3" type="audio/mp3">
    </audio>

    <div class="top-controls">
        <button id="musicBtn" class="icon-btn" onclick="toggleMusic()" title="–ú—É–∑—ã–∫–∞">üîá</button>
        
        <select id="uiLangSelect" class="lang-select" onchange="changeUILanguage()">
            <option value="kk">üá∞üáø “ö–ê–ó</option>
            <option value="ru">üá∑üá∫ –†–£–°</option>
            <option value="en">üá∫üá∏ ENG</option>
        </select>
    </div>

    <div id="loginScreen" class="card">
        <div style="font-size: 50px;">üéÖ</div>
        <h1 id="appTitle">–ñ–∞“£–∞ –ñ—ã–ª 2026</h1>
        <p id="appDesc">–ï—Å—ñ–º—ñ“£—ñ–∑–¥—ñ –∂–∞–∑—ã–ø, —Å–∞—è—Ö–∞—Ç—Ç—ã –±–∞—Å—Ç–∞“£—ã–∑!</p>
        
        <input type="text" id="nameInput" placeholder="–ê—Ç—ã“£—ã–∑...">
        <button onclick="startJourney()" class="main-btn" id="btnStart">–ë–∞—Å—Ç–∞—É üöÄ</button>
    </div>

    <div id="journeyScreen" class="card hidden">
        <div style="font-family: monospace; color:#ffeb3b; background:rgba(0,0,0,0.5); padding:5px 10px; border-radius:15px; display:inline-block;" id="localTime">00:00</div>
        
        <h2 id="cityName" class="city-name">City</h2>
        
        <p id="greetingMsg" class="greeting-text">...</p>
        
        <div id="poemBox" class="poem-box">...</div>

        <button onclick="nextCity()" class="main-btn" id="btnNext">–ö–µ–ª–µ—Å—ñ –µ–ª ‚úàÔ∏è</button>
        <button onclick="shareGreeting()" class="main-btn share-btn" id="btnShare">–ë”©–ª—ñ—Å—É üîó</button>
    </div>

    <script>
        // --- –î–ï–†–ï–ö–¢–ï–† ---
        const uiText = {
            kk: { title: "–ñ–∞“£–∞ –ñ—ã–ª 2026", desc: "–ï—Å—ñ–º—ñ“£—ñ–∑–¥—ñ –∂–∞–∑—ã–ø, —Å–∞—è—Ö–∞—Ç—Ç—ã –±–∞—Å—Ç–∞“£—ã–∑!", ph: "–ê—Ç—ã“£—ã–∑...", start: "–ë–∞—Å—Ç–∞—É üöÄ", next: "–ö–µ–ª–µ—Å—ñ –µ–ª ‚úàÔ∏è", share: "–ë”©–ª—ñ—Å—É üîó", copied: "–ö”©—à—ñ—Ä—ñ–ª–¥—ñ!" },
            ru: { title: "–ù–æ–≤—ã–π –ì–æ–¥ 2026", desc: "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ –Ω–∞—á–Ω–∏—Ç–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ!", ph: "–í–∞—à–µ –∏–º—è...", start: "–ü–æ–µ—Ö–∞–ª–∏ üöÄ", next: "–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∞ ‚úàÔ∏è", share: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è üîó", copied: "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!" },
            en: { title: "New Year 2026", desc: "Enter your name to start!", ph: "Your name...", start: "Start Journey üöÄ", next: "Next Country ‚úàÔ∏è", share: "Share üîó", copied: "Copied!" }
        };

        const contentData = {
            kk: {
                greet: "“ö“±—Ä–º–µ—Ç—Ç—ñ {name}, –ñ–∞“£–∞ –∂—ã–ª—ã“£—ã–∑–±–µ–Ω! –û—Å—ã “õ–∞–ª–∞–Ω—ã“£ —Å“±–ª—É–ª—ã“ì—ã–Ω–¥–∞–π ”©–º—ñ—Ä—ñ“£—ñ–∑ –∂–∞—Ä“õ—ã–Ω –±–æ–ª—Å—ã–Ω!",
                poem: "–ñ–∞“£–∞ –∂—ã–ª–¥–∞ –∂–∞“£–∞ –±–∞“õ—ã—Ç –∫–µ–∑ –±–æ–ª—Å—ã–Ω,\n”ò—Ä–±—ñ—Ä –∫“Ø–Ω—ñ“£ “õ—É–∞–Ω—ã—à“õ–∞ —Ç–µ–∑ —Ç–æ–ª—Å—ã–Ω.\n–ê—Ä–º–∞–Ω–¥–∞—Ä—ã“£ –±–∏—ñ–∫—Ç–µ—Ä–≥–µ —Å–∞–º“ì–∞—Å—ã–Ω,\n–ñ–∞“õ—Å—ã–ª—ã“õ—Ç–∞—Ä –∂–∞–Ω—ã“£—ã–∑–¥–∞–Ω “õ–∞–ª–º–∞—Å—ã–Ω!"
            },
            ru: {
                greet: "–î–æ—Ä–æ–≥–æ–π(–∞—è) {name}, –° –ù–æ–≤—ã–º –ì–æ–¥–æ–º! –ü—É—Å—Ç—å —ç—Ç–æ—Ç –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å–µ—Ç —Å—Ç–æ–ª—å–∫–æ —Å—á–∞—Å—Ç—å—è, —Å–∫–æ–ª—å–∫–æ –æ–≥–Ω–µ–π –≤ —ç—Ç–æ–º –≥–æ—Ä–æ–¥–µ!",
                poem: "–ü—É—Å—Ç—å –ù–æ–≤—ã–π –≥–æ–¥ –¥–æ–±—Ä–æ –Ω–µ—Å–µ—Ç,\n–ò —Å—á–∞—Å—Ç—å–µ –≤ –¥–æ–º–µ —Ä–∞—Å—Ü–≤–µ—Ç–µ—Ç.\n–ü—É—Å—Ç—å —Å–±—É–¥—É—Ç—Å—è –º–µ—á—Ç—ã —Å–ø–æ–ª–Ω–∞,\n–ò –±—É–¥–µ—Ç –∂–∏–∑–Ω—å –ª—é–±–≤–∏ –ø–æ–ª–Ω–∞!"
            },
            en: {
                greet: "Dear {name}, Happy New Year! Wishing you a year as bright and wonderful as this city!",
                poem: "May this New Year bring you light,\nMake your future warm and bright.\nJoy and peace in every day,\nSuccess and love will come your way!"
            },
            fr: {
                greet: "Cher {name}, Bonne Ann√©e! Que cette ann√©e vous apporte joie, bonheur et prosp√©rit√©!",
                poem: "Que cette ann√©e soit pleine de joie,\nQue le bonheur soit avec toi.\nSant√©, succ√®s et jours heureux,\nVoil√† mes plus sinc√®res v≈ìux !"
            },
            tr: {
                greet: "Sevgili {name}, Yeni Yƒ±lƒ±nƒ±z Kutlu Olsun! T√ºm dileklerinizin ger√ßekle≈ümesi dileƒüiyle!",
                poem: "Yeni yƒ±l sana huzur getirsin,\nT√ºm dertlerin artƒ±k bitsin.\nY√ºz√ºn her an ne≈üeyle g√ºls√ºn,\nHayallerin ger√ßeƒüe d√∂ns√ºn!"
            },
            ar: {
                greet: "ÿπÿ≤Ÿäÿ≤Ÿä {name}ÿå ÿπÿßŸÖ ÿ≥ÿπŸäÿØ! ÿ£ÿ™ŸÖŸÜŸâ ŸÑŸÉ ÿ≠Ÿäÿßÿ© ŸÖŸÑŸäÿ¶ÿ© ÿ®ÿßŸÑÿ≥ÿπÿßÿØÿ© ŸàÿßŸÑŸÜÿ¨ÿßÿ≠!",
                poem: "ÿπÿßŸÖ ÿ¨ÿØŸäÿØ ŸäŸáŸÑ ÿ®ÿßŸÑŸÜŸàÿ±ÿå\nŸäŸÖŸÑÿ£ ŸÇŸÑÿ®ŸÉ ÿ®ÿßŸÑÿ≥ÿ±Ÿàÿ±.\nÿ™ÿ≠ŸÇŸÇ ŸÅŸäŸá ŸÉŸÑ ÿßŸÑÿ£ŸÖÿßŸÜŸäÿå\nŸàÿ™ÿπŸäÿ¥ ŸÅŸä ÿÆŸäÿ± Ÿàÿ™ŸáÿßŸÜŸä."
            },
            zh: {
                greet: "‰∫≤Áà±ÁöÑ {name}, Êñ∞Âπ¥Âø´‰πê! ÊÑø‰Ω†Êñ∞ÁöÑ‰∏ÄÂπ¥‰∏á‰∫ãÂ¶ÇÊÑèÔºåÂøÉÊÉ≥‰∫ãÊàê!",
                poem: "Êñ∞Âπ¥Êù•‰∏¥ÂñúÊ∞îÊµìÔºå\n‰∏á‰∫ãÂ¶ÇÊÑè‰πêËûçËûç„ÄÇ\nÊÑø‰Ω†Ê¢¶ÊÉ≥ÁöÜÊàêÁúüÔºå\nÂπ∏Á¶èÂÆâÂ∫∑‰º¥‰∏ÄÁîü„ÄÇ"
            }
        };

        const destinations = [
            { name: "Astana üá∞üáø", tz: "Asia/Almaty", lang: "kk" },
            { name: "Paris üá´üá∑", tz: "Europe/Paris", lang: "fr" },
            { name: "New York üá∫üá∏", tz: "America/New_York", lang: "en" },
            { name: "Istanbul üáπüá∑", tz: "Europe/Istanbul", lang: "tr" },
            { name: "Dubai üá¶üá™", tz: "Asia/Dubai", lang: "ar" },
            { name: "Beijing üá®üá≥", tz: "Asia/Shanghai", lang: "zh" },
            { name: "Moscow üá∑üá∫", tz: "Europe/Moscow", lang: "ru" },
            { name: "London üá¨üáß", tz: "Europe/London", lang: "en" }
        ];

        // --- –õ–û–ì–ò–ö–ê ---
        let currentDestIndex = 0;
        let userName = "Dosym";
        const audio = document.getElementById('bgMusic');
        let isMusicPlaying = false;

        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            if(urlParams.get('name')) {
                document.getElementById('nameInput').value = urlParams.get('name');
            }
            createSnow();
            changeUILanguage(); // Set initial lang
        };

        // –¢—ñ–ª –∞—É—ã—Å—Ç—ã—Ä—É
        function changeUILanguage() {
            const lang = document.getElementById('uiLangSelect').value;
            const t = uiText[lang];
            
            document.getElementById('appTitle').textContent = t.title;
            document.getElementById('appDesc').textContent = t.desc;
            document.getElementById('nameInput').placeholder = t.ph;
            document.getElementById('btnStart').textContent = t.start;
            document.getElementById('btnNext').textContent = t.next;
            document.getElementById('btnShare').textContent = t.share;
        }

        // –ú—É–∑—ã–∫–∞–Ω—ã “õ–æ—Å—É/”©—à—ñ—Ä—É
        function toggleMusic() {
            const btn = document.getElementById('musicBtn');
            if (isMusicPlaying) {
                audio.pause();
                isMusicPlaying = false;
                btn.innerHTML = "üîá";
                btn.classList.remove('playing');
            } else {
                audio.play().then(() => {
                    isMusicPlaying = true;
                    btn.innerHTML = "üéµ";
                    btn.classList.add('playing');
                }).catch(err => {
                    alert("–ú—É–∑—ã–∫–∞ –æ–π–Ω–∞—É “Ø—à—ñ–Ω —ç–∫—Ä–∞–Ω–¥—ã –±—ñ—Ä —Ä–µ—Ç –±–∞—Å—ã“£—ã–∑!");
                });
            }
        }

        function startJourney() {
            const input = document.getElementById('nameInput');
            userName = input.value.trim() || "Friend";
            
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('journeyScreen').classList.remove('hidden');
            
            confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 } });
            
            // –ï–≥–µ—Ä –º—É–∑—ã–∫–∞ “õ–æ—Å—ã–ª–º–∞“ì–∞–Ω –±–æ–ª—Å–∞, –æ–Ω—ã “õ–æ—Å—É“ì–∞ —Ç—ã—Ä—ã—Å–∞–º—ã–∑
            if(!isMusicPlaying) toggleMusic();
            
            updateContent();
            setInterval(updateTime, 1000);
        }

        function updateContent() {
            const city = destinations[currentDestIndex];
            const langCode = contentData[city.lang] ? city.lang : 'en';
            const data = contentData[langCode];

            document.getElementById('cityName').textContent = city.name;
            document.getElementById('greetingMsg').innerHTML = data.greet.replace("{name}", `<b style="color:#ffeb3b">${userName}</b>`);
            document.getElementById('poemBox').textContent = data.poem;
            
            updateTime();
        }

        function nextCity() {
            const card = document.getElementById('journeyScreen');
            card.style.transform = 'scale(0.9) translateX(-20px)';
            card.style.opacity = '0';
            
            setTimeout(() => {
                currentDestIndex = (currentDestIndex + 1) % destinations.length;
                updateContent();
                card.style.transform = 'scale(1) translateX(0)';
                card.style.opacity = '1';
                confetti({ particleCount: 50, spread: 60, origin: { y: 0.7 } });
            }, 300);
        }

        function updateTime() {
            const city = destinations[currentDestIndex];
            try {
                const now = new Date();
                const timeStr = new Intl.DateTimeFormat('en-GB', { timeZone: city.tz, hour: '2-digit', minute: '2-digit', second: '2-digit' }).format(now);
                document.getElementById('localTime').textContent = timeStr;
            } catch(e) { }
        }

        function shareGreeting() {
            const url = window.location.protocol + "//" + window.location.host + window.location.pathname + "?name=" + encodeURIComponent(userName);
            const lang = document.getElementById('uiLangSelect').value;
            
            if (navigator.share) {
                navigator.share({ title: 'New Year Wish', url: url });
            } else {
                navigator.clipboard.writeText(url).then(() => {
                    const btn = document.getElementById('btnShare');
                    const original = btn.textContent;
                    btn.textContent = uiText[lang].copied;
                    setTimeout(() => btn.textContent = original, 2000);
                });
            }
        }

        function createSnow() {
            setInterval(() => {
                const snow = document.createElement('div');
                snow.className = 'snowflake';
                snow.innerHTML = '‚ùÑ';
                snow.style.left = Math.random() * 100 + 'vw';
                snow.style.fontSize = Math.random() * 15 + 10 + 'px';
                snow.style.animationDuration = Math.random() * 5 + 5 + 's';
                document.body.appendChild(snow);
                setTimeout(() => snow.remove(), 10000);
            }, 300);
        }
    </script>
</body>
</html>
