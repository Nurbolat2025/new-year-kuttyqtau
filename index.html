<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global New Year Wish</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#d32f2f">
    <link rel="icon" type="image/png" href="icon-192.png">

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        body {
            margin: 0; padding: 20px;
            min-height: 100vh;
            background: linear-gradient(135deg, #141E30, #243B55);
            color: white;
            text-align: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        /* “ö–∞—Ä –∂–∞—É—É —ç—Ñ—Ñ–µ–∫—Ç—ñ—Å—ñ */
        body::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('https://library.kissclipart.com/20180904/ese/kissclipart-falling-snow-png-clipart-snow-clip-art-4c1b525046522064.png');
            animation: snow 20s linear infinite;
            opacity: 0.3; pointer-events: none; z-index: -1;
        }
        @keyframes snow { from { background-position: 0 0; } to { background-position: 0 500px; } }

        h1 { color: #ffeb3b; text-shadow: 2px 2px 5px #000; font-size: 2rem; margin-bottom: 0.5em;}
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            max-width: 500px;
            width: 100%;
            transition: transform 0.3s;
        }
        .card:hover { transform: translateY(-5px); }

        input, select, button {
            width: 80%; padding: 12px; margin: 10px 0;
            border-radius: 10px; border: none; font-size: 16px;
        }
        button {
            background: #ff5722; color: white; font-weight: bold; cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 87, 34, 0.4);
            transition: 0.2s;
        }
        button:active { transform: scale(0.95); }
        button.secondary { background: #009688; }
        
        .hidden { display: none; }
        
        .city-title { color: #4dd0e1; font-size: 1.5rem; margin-top: 0;}
        .greeting-text { font-size: 1.1rem; margin: 15px 0; }
        
        /* ”®–ª–µ“£–≥–µ –∞—Ä–Ω–∞–ª“ì–∞–Ω —Å—Ç–∏–ª—å */
        .poem-box {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-style: italic;
            line-height: 1.6;
            color: #fffde7;
            border-left: 4px solid #ffeb3b;
            white-space: pre-line; /* ”®–ª–µ“£ –∂–æ–ª–¥–∞—Ä—ã–Ω —Å–∞“õ—Ç–∞—É “Ø—à—ñ–Ω */
        }

        .time-display { font-family: monospace; font-size: 1.2rem; color: #ffeb3b; background: rgba(0,0,0,0.3); padding: 5px 15px; border-radius: 20px; display: inline-block; margin-bottom: 15px;}
        
        #shareLink { font-size: 12px; color: #aaa; margin-top: 5px; }
    </style>
</head>
<body>

    <div id="loginScreen" class="card">
        <h1 id="appTitle">üéÑ –ñ–∞“£–∞ –ñ—ã–ª–¥—ã“õ “ö“±—Ç—Ç—ã“õ—Ç–∞—É</h1>
        <p id="appDesc">–ê—Ç—ã“£—ã–∑–¥—ã –µ–Ω–≥—ñ–∑—ñ–ø, —Å–∞—è—Ö–∞—Ç—Ç—ã –±–∞—Å—Ç–∞“£—ã–∑!</p>
        
        <select id="langSelect" onchange="manualLangChange()">
            </select>
        
        <input type="text" id="nameInput" placeholder="...">
        <button onclick="startJourney()" id="btnStart">–ë–∞—Å—Ç–∞—É üöÄ</button>
    </div>

    <div id="journeyScreen" class="card hidden">
        <h1 id="mainTitle">“ö“±—Ç—Ç—ã –±–æ–ª—Å—ã–Ω!</h1>
        
        <div class="city-content">
            <h2 id="cityName" class="city-title">City</h2>
            <div id="localTime" class="time-display">00:00</div>
            
            <p id="greetingMsg" class="greeting-text">Message</p>
            
            <div id="poemMsg" class="poem-box"></div>
        </div>

        <button onclick="nextCity()" id="btnNext">–ö–µ–ª–µ—Å—ñ “õ–∞–ª–∞ ‚úàÔ∏è</button>
        <button onclick="shareGreeting()" class="secondary" id="btnShare">–î–æ—Å—ã–º–∞ –∂—ñ–±–µ—Ä—É üîó</button>
    </div>

    <script>
        // 1. –ë–ê–†–õ–´“ö –¢–Ü–õ–î–ï–† –ë–ê–ó–ê–°–´ (”®–ª–µ“£–¥–µ—Ä “õ–æ—Å—ã–ª–¥—ã)
        const translations = {
            kk: { 
                title: "–ñ–∞“£–∞ –ñ—ã–ª –°–∞—è—Ö–∞—Ç—ã", desc: "–ê—Ç—ã“£—ã–∑–¥—ã –∂–∞–∑—ã“£—ã–∑:", start: "–ë–∞—Å—Ç–∞—É üöÄ", next: "–ö–µ–ª–µ—Å—ñ –µ–ª ‚úàÔ∏è", share: "–î–æ—Å—ã–º–∞ –∂—ñ–±–µ—Ä—É üîó", copied: "–°—ñ–ª—Ç–µ–º–µ –∫”©—à—ñ—Ä—ñ–ª–¥—ñ!", 
                greeting: "“ö“±—Ä–º–µ—Ç—Ç—ñ {name}, –ñ–∞“£–∞ –∂—ã–ª—ã“£—ã–∑–±–µ–Ω! {city} —Ç”©—Ä—ñ–Ω–µ–Ω —ã—Å—Ç—ã“õ —Å”ô–ª–µ–º!",
                poem: "–ñ–∞“£–∞ –∂—ã–ª–¥–∞ –∂–∞“£–∞ –±–∞“õ—ã—Ç –∫–µ–∑ –±–æ–ª—Å—ã–Ω,\n”ò—Ä–±—ñ—Ä –∫“Ø–Ω—ñ“£ “õ—É–∞–Ω—ã—à“õ–∞ —Ç–µ–∑ —Ç–æ–ª—Å—ã–Ω.\n–ê—Ä–º–∞–Ω–¥–∞—Ä—ã“£ –±–∏—ñ–∫—Ç–µ—Ä–≥–µ —Å–∞–º“ì–∞—Å—ã–Ω,\n–ñ–∞“õ—Å—ã–ª—ã“õ—Ç–∞—Ä –∂–∞–Ω—ã“£—ã–∑–¥–∞–Ω “õ–∞–ª–º–∞—Å—ã–Ω!"
            },
            ru: { 
                title: "–ù–æ–≤–æ–≥–æ–¥–Ω–µ–µ –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ", desc: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:", start: "–ü–æ–µ—Ö–∞–ª–∏ üöÄ", next: "–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∞ ‚úàÔ∏è", share: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥—Ä—É–≥—É üîó", copied: "–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!", 
                greeting: "–î–æ—Ä–æ–≥–æ–π(–∞—è) {name}, –° –ù–æ–≤—ã–º –ì–æ–¥–æ–º! –ü—Ä–∏–≤–µ—Ç –∏–∑ {city}!",
                poem: "–ü—É—Å—Ç—å –ù–æ–≤—ã–π –≥–æ–¥ –¥–æ–±—Ä–æ –Ω–µ—Å–µ—Ç,\n–ò —Å—á–∞—Å—Ç—å–µ –≤ –¥–æ–º–µ —Ä–∞—Å—Ü–≤–µ—Ç–µ—Ç.\n–ü—É—Å—Ç—å —Å–±—É–¥—É—Ç—Å—è –º–µ—á—Ç—ã —Å–ø–æ–ª–Ω–∞,\n–ò –±—É–¥–µ—Ç –∂–∏–∑–Ω—å –ª—é–±–≤–∏ –ø–æ–ª–Ω–∞!"
            },
            en: { 
                title: "New Year Journey", desc: "Enter your name:", start: "Start üöÄ", next: "Next Country ‚úàÔ∏è", share: "Send to Friend üîó", copied: "Link copied!", 
                greeting: "Dear {name}, Happy New Year! Greetings from {city}!",
                poem: "May this New Year bring you light,\nMake your future warm and bright.\nJoy and peace in every day,\nSuccess and love will come your way!"
            },
            tr: { 
                title: "Yeni Yƒ±l Yolculuƒüu", desc: "Adƒ±nƒ±zƒ± giriniz:", start: "Ba≈üla üöÄ", next: "Sonraki √úlke ‚úàÔ∏è", share: "Arkada≈üa G√∂nder üîó", copied: "Baƒülantƒ± kopyalandƒ±!", 
                greeting: "Sevgili {name}, Yeni Yƒ±lƒ±nƒ±z Kutlu Olsun! {city}'den selamlar!",
                poem: "Yeni yƒ±l sana huzur getirsin,\nT√ºm dertlerin artƒ±k bitsin.\nY√ºz√ºn her an ne≈üeyle g√ºls√ºn,\nHayallerin ger√ßeƒüe d√∂ns√ºn!"
            },
            fr: { 
                title: "Voyage du Nouvel An", desc: "Entrez votre nom:", start: "Commencer üöÄ", next: "Pays Suivant ‚úàÔ∏è", share: "Envoyer √† un ami üîó", copied: "Lien copi√©!", 
                greeting: "Cher {name}, Bonne Ann√©e! Salutations de {city}!",
                poem: "Que cette ann√©e soit pleine de joie,\nQue le bonheur soit avec toi.\nSant√©, succ√®s et jours heureux,\nVoil√† mes plus sinc√®res v≈ìux !"
            },
            zh: { 
                title: "Êñ∞Âπ¥‰πãÊóÖ", desc: "ËæìÂÖ•‰Ω†ÁöÑÂêçÂ≠ó:", start: "ÂºÄÂßã üöÄ", next: "‰∏ã‰∏Ä‰∏™ÂõΩÂÆ∂ ‚úàÔ∏è", share: "ÂèëÈÄÅÁªôÊúãÂèã üîó", copied: "ÈìæÊé•Â∑≤Â§çÂà∂!", 
                greeting: "‰∫≤Áà±ÁöÑ {name}, Êñ∞Âπ¥Âø´‰πê! Êù•Ëá™ {city} ÁöÑÈóÆÂÄô!",
                poem: "Êñ∞Âπ¥Êù•‰∏¥ÂñúÊ∞îÊµìÔºå\n‰∏á‰∫ãÂ¶ÇÊÑè‰πêËûçËûç„ÄÇ\nÊÑø‰Ω†Ê¢¶ÊÉ≥ÁöÜÊàêÁúüÔºå\nÂπ∏Á¶èÂÆâÂ∫∑‰º¥‰∏ÄÁîü„ÄÇ"
            },
            ar: { 
                title: "ÿ±ÿ≠ŸÑÿ© ÿßŸÑÿπÿßŸÖ ÿßŸÑÿ¨ÿØŸäÿØ", desc: "ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖŸÉ:", start: "Ÿäÿ®ÿØÿ£ üöÄ", next: "ÿßŸÑÿ®ŸÑÿØ ÿßŸÑÿ™ÿßŸÑŸä ‚úàÔ∏è", share: "ÿ£ÿ±ÿ≥ŸÑ ŸÑÿµÿØŸäŸÇ üîó", copied: "ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿßÿ®ÿ∑!", 
                greeting: "ÿπÿ≤Ÿäÿ≤Ÿä {name}ÿå ÿ≥ŸÜÿ© ÿ¨ÿØŸäÿØÿ© ÿ≥ÿπŸäÿØÿ©! ÿ™ÿ≠Ÿäÿßÿ™Ÿä ŸÖŸÜ {city}!",
                poem: "ÿπÿßŸÖ ÿ¨ÿØŸäÿØ ŸäŸáŸÑ ÿ®ÿßŸÑŸÜŸàÿ±ÿå\nŸäŸÖŸÑÿ£ ŸÇŸÑÿ®ŸÉ ÿ®ÿßŸÑÿ≥ÿ±Ÿàÿ±.\nÿ™ÿ≠ŸÇŸÇ ŸÅŸäŸá ŸÉŸÑ ÿßŸÑÿ£ŸÖÿßŸÜŸäÿå\nŸàÿ™ÿπŸäÿ¥ ŸÅŸä ÿÆŸäÿ± Ÿàÿ™ŸáÿßŸÜŸä."
            }
        };

        // 2. “ö–ê–õ–ê–õ–ê–† (–ë“±–ª –∂–µ—Ä ”©–∑–≥–µ—Ä—ñ—Å—Å—ñ–∑ “õ–∞–ª–¥—ã)
        const destinations = [
            { name: "Almaty, Kazakhstan", tz: "Asia/Almaty" },
            { name: "New York, USA", tz: "America/New_York" },
            { name: "Tokyo, Japan", tz: "Asia/Tokyo" },
            { name: "Istanbul, Turkey", tz: "Europe/Istanbul" },
            { name: "Paris, France", tz: "Europe/Paris" },
            { name: "Dubai, UAE", tz: "Asia/Dubai" },
            { name: "Beijing, China", tz: "Asia/Shanghai" },
            { name: "London, UK", tz: "Europe/London" },
            { name: "Sydney, Australia", tz: "Australia/Sydney" }
        ];

        let currentLang = 'en'; 
        let userName = '';
        let currentDestIndex = 0;

        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const sharedName = urlParams.get('name');
            detectLanguage();
            populateLangSelect();
            updateUIText();
            if (sharedName) {
                document.getElementById('nameInput').value = sharedName;
                startJourney();
            }
        };

        function detectLanguage() {
            const browserLang = navigator.language.slice(0, 2);
            if (translations[browserLang]) currentLang = browserLang;
            document.getElementById('langSelect').value = currentLang;
        }

        function populateLangSelect() {
            const select = document.getElementById('langSelect');
            const langNames = { kk: "“ö–∞–∑–∞“õ—à–∞", ru: "–†—É—Å—Å–∫–∏–π", en: "English", tr: "T√ºrk√ße", fr: "Fran√ßais", zh: "‰∏≠Êñá", ar: "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©" };
            for (let key in translations) {
                let opt = document.createElement('option');
                opt.value = key;
                opt.textContent = langNames[key] || key.toUpperCase();
                select.appendChild(opt);
            }
            select.value = currentLang;
        }

        function manualLangChange() {
            currentLang = document.getElementById('langSelect').value;
            updateUIText();
            if(!document.getElementById('journeyScreen').classList.contains('hidden')){
                updateGreetingCard(); 
            }
        }

        function updateUIText() {
            const t = translations[currentLang];
            document.getElementById('appTitle').textContent = t.title;
            document.getElementById('appDesc').textContent = t.desc;
            document.getElementById('btnStart').textContent = t.start;
            document.getElementById('btnNext').textContent = t.next;
            document.getElementById('btnShare').textContent = t.share;
            document.getElementById('nameInput').placeholder = (currentLang === 'kk' ? "–ú—ã—Å–∞–ª—ã: –ê–π–∂–∞–Ω" : "Name...");
        }

        function startJourney() {
            const input = document.getElementById('nameInput');
            userName = input.value.trim() || "Friend";
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('journeyScreen').classList.remove('hidden');
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            updateGreetingCard();
            setInterval(updateTime, 1000);
        }

        function updateGreetingCard() {
            const cityObj = destinations[currentDestIndex];
            const t = translations[currentLang];
            
            // “ö—ã—Å“õ–∞—à–∞ “õ“±—Ç—Ç—ã“õ—Ç–∞—É–¥—ã –∂–∞“£–∞—Ä—Ç—É
            let msg = t.greeting.replace("{name}", `<strong style="color:#ffeb3b">${userName}</strong>`);
            msg = msg.replace("{city}", cityObj.name);

            document.getElementById('cityName').textContent = cityObj.name;
            document.getElementById('greetingMsg').innerHTML = msg;
            
            // ”®–õ–ï“¢–î–Ü –ñ–ê“¢–ê–†–¢–£
            document.getElementById('poemMsg').textContent = t.poem;
            
            updateTime();
        }

        function nextCity() {
            currentDestIndex = (currentDestIndex + 1) % destinations.length;
            const card = document.getElementById('journeyScreen');
            card.style.transform = 'scale(0.95)';
            setTimeout(() => card.style.transform = 'scale(1)', 200);
            confetti({ particleCount: 100, spread: 60, origin: { y: 0.7 } });
            updateGreetingCard();
        }

        function updateTime() {
            const cityObj = destinations[currentDestIndex];
            const now = new Date();
            const options = { timeZone: cityObj.tz, hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            try {
                const timeStr = new Intl.DateTimeFormat('en-US', options).format(now);
                document.getElementById('localTime').textContent = timeStr;
            } catch (e) {
                document.getElementById('localTime').textContent = "--:--";
            }
        }

        function shareGreeting() {
            const url = window.location.protocol + "//" + window.location.host + window.location.pathname + "?name=" + encodeURIComponent(userName);
            if (navigator.share) {
                navigator.share({
                    title: 'New Year Wish',
                    text: `Special greeting for ${userName}`,
                    url: url,
                }).catch(console.error);
            } else {
                navigator.clipboard.writeText(url).then(() => {
                    const t = translations[currentLang];
                    const originalText = document.getElementById('btnShare').textContent;
                    document.getElementById('btnShare').textContent = t.copied;
                    setTimeout(() => {
                        document.getElementById('btnShare').textContent = originalText;
                    }, 2000);
                });
            }
        }
    </script>
</body>
</html>
